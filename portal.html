<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Brandible Hub ‚Äì Dashboard</title>
  
  <!-- Google Fonts - Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
    }
  </script>
  
  <!-- Supabase JS Client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <style>
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
  </style>
  <!-- Netlify Identity Widget -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    if (window.netlifyIdentity) {
      window.netlifyIdentity.init();
    }
  </script>
  <link rel="stylesheet" href="/assets/css/styles.css" />
  <script defer src="/assets/js/auth.js"></script>
  <script defer src="/assets/js/portal.js"></script>

  <!-- Tailwind component layer -->
  <style type="text/tailwindcss">
    @layer components {
      .pill { @apply inline-flex items-center gap-1 px-2 py-1 text-xs rounded-full font-medium; }
      .pill-green { @apply pill bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300; }
      .pill-amber { @apply pill bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-300; }
      .pill-slate { @apply pill bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300; }
      .card-body { @apply p-4 md:p-5; }
      .sidebar-link { @apply flex items-center gap-3 px-3 py-2 rounded-xl text-slate-600 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-300 dark:hover:bg-slate-800 dark:hover:text-white; }
      .sidebar-link-active { @apply bg-slate-900 text-white dark:bg-white dark:text-slate-900; }
    }
  </style>

  <script>
    // Dark mode toggle + persist
    function toggleDark() {
      const key = 'brandible.dark';
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem(key, isDark ? '1' : '0');
    }
    
    // Initialize dark mode on page load
    (function(){
      const key = 'brandible.dark';
      const saved = localStorage.getItem(key);
      if (saved === '1') document.documentElement.classList.add('dark');
      // Make toggleDark globally available
      window.toggleDark = toggleDark;
    })();
  </script>
</head>
<body class="h-full gradient-bg dark:bg-slate-950 text-slate-900 dark:text-slate-100 fade-in">
  <div class="min-h-screen grid grid-cols-1 lg:grid-cols-[260px,1fr]">
    <!-- Sidebar -->
    <aside class="hidden lg:block border-r border-slate-200/50 dark:border-slate-800/50 bg-white/80 dark:bg-slate-900/60 backdrop-blur-2xl">
      <div class="p-6 pb-4">
        <div class="flex items-center gap-3 mb-1">
          <div class="w-12 h-12 rounded-2xl bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 shadow-lg shadow-purple-500/30 flex items-center justify-center">
            <span class="text-2xl font-bold text-white">B</span>
          </div>
        </div>
        <h1 class="font-bold text-lg text-slate-900 dark:text-white mb-1">Brandible Hub</h1>
        <p class="text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">Client Portal</p>
      </div>
      <div class="px-6 pb-4 border-b border-slate-200/50 dark:border-slate-800/50"></div>
      <nav class="px-4 py-4 space-y-1" id="portalSideNav">
        <a href="#overview" class="sidebar-link sidebar-link-active" data-target="overview"><span>Overview</span></a>
        <a href="#projects" class="sidebar-link" data-target="projects"><span>Projects</span></a>
        <a href="#filesCard" class="sidebar-link" data-target="filesCard"><span>Files</span></a>
        <a href="#invoicesCard" class="sidebar-link" data-target="invoicesCard"><span>Invoices</span></a>
        <a href="#accountSettings" class="sidebar-link" data-target="accountSettings"><span>Account Settings</span></a>
        <a href="#brandInfo" class="sidebar-link" data-target="brandInfo"><span>Brand Info</span></a>
        <a href="#feedback" class="sidebar-link" data-target="feedback"><span>Feedback</span></a>
        <a href="#resources" class="sidebar-link" data-target="resources"><span>Resources</span></a>
        <a href="#support" class="sidebar-link" data-target="support"><span>Support</span></a>
      </nav>
      
      <div class="px-4 pt-4 border-t border-slate-200/50 dark:border-slate-800/50">
        <button onclick="toggleDark()" class="w-full btn-ghost">
          <span class="flex items-center justify-center gap-2">
            <span class="text-lg">üåó</span>
            <span class="text-sm">Dark Mode</span>
          </span>
        </button>
      </div>
    </aside>

    <!-- Main -->
    <div class="flex flex-col min-h-screen">
      <!-- Topbar -->
      <header class="glass-header sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-3 justify-between">
          <div class="flex items-center gap-3 lg:hidden">
            <div class="w-10 h-10 rounded-2xl bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 shadow-lg shadow-purple-500/30 flex items-center justify-center">
              <span class="text-xl font-bold text-white">B</span>
            </div>
            <div>
              <div class="font-bold text-base">Brandible Hub</div>
              <div class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wider">Client Portal</div>
            </div>
          </div>
          <div class="hidden md:flex items-center gap-2 flex-1 max-w-xl">
            <div class="relative w-full">
              <input id="globalSearch" placeholder="Search projects, files, invoices‚Ä¶" class="w-full rounded-xl border border-slate-200/50 dark:border-slate-700/50 bg-white/70 dark:bg-slate-900/50 px-4 py-2.5 pl-10 outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-300 dark:focus:border-purple-700 transition-all" />
              <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <span id="userEmail" class="hidden sm:inline text-sm text-slate-500"></span>
            <div class="btn-surface"><button id="openNotifications" class="btn-icon" title="Notifications">üîî</button></div>
            <div class="btn-surface"><button onclick="toggleDark()" class="btn-icon" title="Dark mode">üåó</button></div>
            <div class="btn-surface"><button onclick="refreshClientData()" class="btn-ghost" title="Refresh data"><span class="icon">üîÑ</span> Refresh</button></div>
            <button id="logoutBtn" class="btn-ghost">Log out</button>
          </div>
        </div>
      </header>
          <!-- Notifications Panel -->
          <div id="notificationsPanel" class="hidden fixed top-16 right-4 z-[3000] w-80 max-h-[70vh] overflow-y-auto card p-4">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-semibold">Notifications</h3>
              <span id="unreadBadge" class="pill-slate">0</span>
            </div>
            <ul id="notificationsList" class="space-y-2"></ul>
          </div>

      <main class="flex-1 max-w-[1200px] mx-auto w-full px-4 sm:px-6 py-6 space-y-6">
        <!-- Welcome Header -->
        <section id="welcomeHeader" class="card-section">
          <h1 id="welcomeMessage" class="text-2xl font-bold text-slate-900 dark:text-slate-100">Welcome back! üëã</h1>
        </section>

        <!-- Profile Completion -->
        <section id="profileCompletion" class="card-section">
          <div class="flex items-center justify-between mb-3">
            <h2 class="section-title">Profile Completion</h2>
            <span id="profileCompletionPercent" class="text-sm font-semibold text-purple-600 dark:text-purple-400">0%</span>
          </div>
          <div class="w-full bg-slate-200 dark:bg-slate-800 rounded-full h-3 mb-2">
            <div id="profileCompletionBar" class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
          </div>
          <div id="profileCompletionMissing" class="text-xs text-slate-500 dark:text-slate-400">
            <p>Complete your profile to unlock all features.</p>
          </div>
        </section>

        <!-- Profile -->
        <section id="profile" class="card-section">
          <h2 class="section-title">Profile</h2>
          <div id="profileCard" class="flex flex-col sm:flex-row items-center sm:items-center gap-4"></div>
        </section>

        <!-- KPIs -->
        <section id="overview" class="card-section">
          <h2 class="section-title">Overview</h2>
          <div id="kpis" class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4"></div>
        </section>

        <!-- Projects Section -->
        <div class="card-section">
            <div class="flex items-center justify-between mb-4">
              <h2 class="section-title">Projects</h2>
              <div class="flex items-center gap-2">
                <button class="btn-ghost text-sm" id="filterActive">Active</button>
                <button class="btn-ghost text-sm" id="filterAll">All</button>
              </div>
            </div>
            <div class="projects-grid" id="kanban">
              <div class="project-column">
                <h3>In Progress</h3>
                <div class="space-y-2" id="col-progress"></div>
              </div>
              <div class="project-column">
                <h3>Review</h3>
                <div class="space-y-2" id="col-review"></div>
              </div>
              <div class="project-column">
                <h3>Done</h3>
                <div class="space-y-2" id="col-done"></div>
              </div>
            </div>
            <!-- Fallback list for existing portal.js renderer -->
            <div id="projects" class="hidden"></div>
          </div>

          <!-- Recent Activity -->
          <div class="card-section">
            <h2 class="section-title">Recent Activity</h2>
            <ul id="activity" class="space-y-3"></ul>
          </div>

          <!-- Files Section -->
          <div class="card-section" id="filesCard">
            <div class="flex items-center justify-between mb-4">
              <h2 class="section-title">Files</h2>
                <label class="btn-primary text-sm cursor-pointer">
                  <svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                  </svg>
                  Upload
                  <input id="fileInput" type="file" class="hidden" accept=".pdf,.jpg,.jpeg,.png,.docx,.doc" multiple />
                </label>
            </div>
            <!-- Upload Progress -->
            <div id="uploadProgress" class="hidden mb-4">
              <div class="flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400 mb-2">
                <div class="animate-spin rounded-full h-4 w-4 border-2 border-purple-500 border-t-transparent"></div>
                <span id="uploadStatus">Uploading...</span>
              </div>
              <div class="w-full bg-slate-200 dark:bg-slate-800 rounded-full h-2">
                <div id="progressBar" class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 h-2 rounded-full transition-all" style="width: 0%"></div>
              </div>
            </div>
            
            <!-- File List -->
            <ul id="files" class="space-y-2 min-h-[100px]"></ul>
            
            <!-- Empty State -->
            <div id="filesEmpty" class="text-center py-8 text-slate-400">
              <svg class="w-12 h-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <p class="text-sm">No files yet</p>
              <p class="text-xs mt-1">Click Upload to add files</p>
            </div>
          </div>

          <!-- Invoices Section -->
          <div class="card-section" id="invoicesCard">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4">
              <div>
            <h2 class="section-title">Invoices</h2>
                <p class="text-xs text-slate-500 dark:text-slate-400">Review your billing history and download receipts.</p>
              </div>
            </div>
            <div class="overflow-x-auto border border-slate-200 dark:border-slate-800 rounded-2xl">
              <table class="w-full text-sm">
                <thead class="text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/40">
                  <tr>
                    <th class="text-left py-3 px-4">Invoice #</th>
                    <th class="text-left py-3 px-4">Date</th>
                    <th class="text-left py-3 px-4">Status</th>
                    <th class="text-left py-3 px-4">Total</th>
                    <th class="text-right py-3 px-4">Actions</th>
                  </tr>
                </thead>
                <tbody id="invoicesTable" class="divide-y divide-slate-200 dark:divide-slate-800"></tbody>
              </table>
            </div>
            <div id="invoicesEmptyState" class="hidden text-center py-10 text-slate-400">
              <svg class="w-12 h-12 mx-auto mb-3 opacity-60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2m-6 0V3a1 1 0 011-1h2a1 1 0 011 1v2m-6 4h8" />
              </svg>
              <p class="text-sm">No invoices yet</p>
              <p class="text-xs mt-1">Your invoices will appear here once the team sends one.</p>
            </div>
          </div>

          <!-- Account Settings -->
          <div class="card-section" id="accountSettings">
            <h2 class="section-title">Account Settings</h2>
            <div class="grid gap-4 max-w-xl">
              <div>
                <label class="block text-sm font-medium text-slate-600">Name</label>
                <input id="accountName" class="input-field w-full" disabled />
              </div>
              <div>
                <label class="block text-sm font-medium text-slate-600">Email</label>
                <input id="accountEmail" class="input-field w-full" disabled />
              </div>
              <div class="mt-2">
                <label class="block text-sm font-medium text-slate-600 mb-2">Notifications</label>
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" id="settingEmailNotifications" class="rounded"/> Email notifications</label>
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" id="settingInvoiceReminders" class="rounded"/> Invoice reminders</label>
              </div>
              <div class="flex gap-2">
                <button id="saveSettingsBtn" class="btn-primary">Save Settings</button>
                <a id="passwordResetLink" class="btn-ghost" href="#">Reset Password</a>
              </div>
            </div>
          </div>

          <!-- Brand Info -->
          <div class="card-section" id="brandInfo">
            <h2 class="section-title">Brand Info</h2>
            <div id="brandInfoCard" class="card p-5">
              <div class="flex items-start gap-4">
                <img id="brandLogo" class="w-20 h-20 object-cover rounded-xl border border-slate-200" src="" alt="Brand Logo"/>
                <div class="flex-1">
                  <div class="mb-3">
                    <p class="text-sm font-semibold mb-1">Brand Colors</p>
                    <div id="brandColors" class="flex items-center gap-2"></div>
                  </div>
                  <p class="text-sm"><span class="font-semibold">Fonts:</span> <span id="brandFonts"></span></p>
                  <p class="text-sm mt-2"><span class="font-semibold">Target Audience:</span> <span id="brandAudience"></span></p>
                </div>
              </div>
            </div>
          </div>

          <!-- Feedback Section -->
          <div class="card-section" id="feedback">
            <h2 class="section-title">Project Feedback</h2>
            <p class="text-sm text-slate-600 dark:text-slate-300 mb-4">Share your thoughts on completed projects. Help us improve!</p>
            
            <div id="feedbackForm" class="space-y-4 mb-6">
              <div>
                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Select Project</label>
                <select id="feedbackProjectSelect" class="w-full rounded-xl border border-slate-200/50 dark:border-slate-700/50 bg-white/70 dark:bg-slate-900/50 px-4 py-3 outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-300 dark:focus:border-purple-700 transition-all">
                  <option value="">Choose a project...</option>
                </select>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Rating</label>
                <div id="ratingStars" class="flex gap-2">
                  <button type="button" class="rating-star text-2xl text-slate-300 hover:text-yellow-400 transition-colors" data-rating="1">‚≠ê</button>
                  <button type="button" class="rating-star text-2xl text-slate-300 hover:text-yellow-400 transition-colors" data-rating="2">‚≠ê</button>
                  <button type="button" class="rating-star text-2xl text-slate-300 hover:text-yellow-400 transition-colors" data-rating="3">‚≠ê</button>
                  <button type="button" class="rating-star text-2xl text-slate-300 hover:text-yellow-400 transition-colors" data-rating="4">‚≠ê</button>
                  <button type="button" class="rating-star text-2xl text-slate-300 hover:text-yellow-400 transition-colors" data-rating="5">‚≠ê</button>
                </div>
                <p id="ratingText" class="text-xs text-slate-500 dark:text-slate-400 mt-1">Select a rating</p>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Comments (Optional)</label>
                <textarea id="feedbackComment" placeholder="Share your feedback..." rows="4" class="w-full rounded-xl border border-slate-200/50 dark:border-slate-700/50 bg-white/70 dark:bg-slate-900/50 px-4 py-3 outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-300 dark:focus:border-purple-700 transition-all"></textarea>
              </div>
              
              <button id="submitFeedback" class="btn-primary w-full">Submit Feedback</button>
            </div>

            <div id="feedbackHistory" class="hidden">
              <h3 class="text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3">Your Feedback History</h3>
              <div id="feedbackHistoryList" class="space-y-3"></div>
            </div>
          </div>

          <!-- Resources Section -->
          <div class="card-section" id="resources">
            <div class="flex items-center justify-between mb-4">
              <h2 class="section-title">Resources</h2>
              <div class="flex items-center gap-2">
                <button class="resource-filter btn-ghost text-sm active" data-category="all">All</button>
                <button class="resource-filter btn-ghost text-sm" data-category="Guides">Guides</button>
                <button class="resource-filter btn-ghost text-sm" data-category="Templates">Templates</button>
                <button class="resource-filter btn-ghost text-sm" data-category="Tutorials">Tutorials</button>
              </div>
            </div>
            
            <div id="resourcesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              <!-- Resources will be loaded here -->
            </div>
            
            <div id="resourcesEmpty" class="hidden text-center py-10 text-slate-400">
              <svg class="w-12 h-12 mx-auto mb-3 opacity-60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
              </svg>
              <p class="text-sm">No resources available</p>
            </div>
          </div>

          <!-- Support Section -->
          <div class="card-section" id="support">
            <h2 class="section-title">Need help?</h2>
            <p class="text-sm text-slate-600 dark:text-slate-300 mb-4">Create a quick support request and we'll get back to you.</p>
            <form name="hub-support" method="POST" data-netlify="true" class="space-y-4">
              <input type="hidden" name="form-name" value="hub-support" />
              <input name="email" placeholder="Your email" class="w-full rounded-xl border border-slate-200/50 dark:border-slate-700/50 bg-white/70 dark:bg-slate-900/50 px-4 py-3 outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-300 dark:focus:border-purple-700 transition-all" />
              <textarea name="message" placeholder="How can we help?" rows="3" class="w-full rounded-xl border border-slate-200/50 dark:border-slate-700/50 bg-white/70 dark:bg-slate-900/50 px-4 py-3 outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-300 dark:focus:border-purple-700 transition-all"></textarea>
              <button class="btn-primary w-full">Submit</button>
            </form>
          </div>

          <!-- Updates Section -->
          <div class="card-section" id="updatesCard">
            <h2 class="section-title">Updates</h2>
            <ul id="updates" class="space-y-3"></ul>
          </div>
      </main>

      <footer class="px-4 py-6 text-center text-xs text-slate-500">
        ¬© <span id="year"></span> Brandible. All rights reserved.
      </footer>
    </div>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
  
  <!-- Invoice Detail Modal -->
  <div id="invoiceDetailModal" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center z-[2600]">
    <div class="bg-white dark:bg-slate-900 rounded-3xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6 sm:p-8 relative">
      <button id="closeInvoiceDetail" class="absolute top-4 right-5 text-slate-500 hover:text-slate-900">‚úï</button>
      <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-6">
        <div>
          <p class="text-xs uppercase tracking-wide text-slate-400">Invoice</p>
          <h3 id="invoiceDetailNumber" class="text-xl font-semibold text-slate-900 dark:text-slate-100">INV-00000</h3>
          <p id="invoiceDetailDate" class="text-sm text-slate-500 dark:text-slate-400"></p>
        </div>
        <div class="text-right">
          <span id="invoiceDetailStatus" class="inline-flex items-center px-3 py-1 text-xs rounded-full bg-slate-100 text-slate-700"></span>
          <p id="invoiceDetailTotal" class="text-lg font-semibold text-[#5B4FFF] mt-2">$0.00</p>
        </div>
      </div>

      <div class="bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-2xl p-4 mb-6">
        <p class="text-xs font-semibold text-slate-500 mb-2">Billed To</p>
        <p id="invoiceDetailClient" class="text-sm text-slate-700 dark:text-slate-200"></p>
        <p id="invoiceDetailEmail" class="text-sm text-slate-500 dark:text-slate-400"></p>
      </div>

      <div class="border border-slate-200 dark:border-slate-700 rounded-2xl overflow-hidden mb-6">
        <table class="w-full text-sm">
          <thead class="bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300">
            <tr>
              <th class="text-left py-3 px-4">Description</th>
              <th class="text-right py-3 px-4">Qty</th>
              <th class="text-right py-3 px-4">Price</th>
              <th class="text-right py-3 px-4">Line Total</th>
          </tr>
          </thead>
          <tbody id="invoiceDetailItems" class="divide-y divide-slate-200 dark:divide-slate-800"></tbody>
        </table>
      </div>

      <div class="space-y-2 border-t border-slate-200 dark:border-slate-700 pt-4">
        <div class="flex items-center justify-between text-sm text-slate-600 dark:text-slate-300">
          <span>Subtotal</span>
          <span id="invoiceDetailSubtotal">$0.00</span>
        </div>
        <div class="flex items-center justify-between text-sm text-slate-600 dark:text-slate-300">
          <span>Tax</span>
          <span id="invoiceDetailTax">$0.00</span>
        </div>
        <div class="flex items-center justify-between text-sm text-slate-600 dark:text-slate-300">
          <span>Discount</span>
          <span id="invoiceDetailDiscount">-$0.00</span>
        </div>
        <div class="flex items-center justify-between text-base font-semibold text-[#5B4FFF]">
          <span>Total</span>
          <span id="invoiceDetailGrandTotal">$0.00</span>
        </div>
      </div>

      <div id="invoiceDetailAttachments" class="mt-6 hidden">
        <p class="text-xs font-semibold text-slate-500 mb-2">Attachments</p>
        <ul class="space-y-2" id="invoiceDetailAttachmentList"></ul>
      </div>

      <div class="mt-6 flex flex-wrap gap-3 justify-end">
        <a id="invoiceDetailPdf" href="#" target="_blank" rel="noopener" class="btn-ghost text-sm hidden">View PDF</a>
        <button id="invoiceDetailPay" class="btn-primary text-sm hidden">Pay Now</button>
        <button id="invoiceDetailCloseBtn" class="btn-ghost text-sm">Close</button>
      </div>
    </div>
  </div>
  <!-- Project Details Modal -->
  <div id="clientProjectModal" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl p-8 relative transition-all duration-300">
      <button id="closeClientProjectModal" class="absolute top-4 right-5 text-slate-500 hover:text-slate-900">‚úï</button>
      <h2 id="clientProjectTitle" class="text-xl font-semibold mb-3"></h2>
      <span id="clientProjectStatus" class="px-3 py-1 text-xs rounded-full bg-slate-100 text-slate-700"></span>
      <p id="clientProjectDescription" class="mt-4 text-slate-700"></p>
      <div class="mt-6 border-t pt-4">
        <h3 class="font-semibold mb-2 text-slate-700">Activity Log</h3>
        <div id="clientProjectActivity" class="space-y-2 max-h-48 overflow-y-auto text-sm text-slate-600"></div>
      </div>
      <div class="mt-6 border-t pt-4">
        <textarea id="clientProjectComment" placeholder="Add a comment..." class="input-field w-full h-20"></textarea>
        <button id="submitProjectComment" class="mt-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-600/90">Post Comment</button>
      </div>
              </div>
            </div>
  <!-- Change Photo Modal -->
  <div id="avatarModal" class="hidden fixed inset-0 z-[2000] bg-black/40 flex items-center justify-center">
    <div class="bg-white dark:bg-slate-900 rounded-2xl p-6 w-full max-w-md shadow-2xl">
      <h3 class="text-lg font-semibold mb-3">Change Profile Photo</h3>
      <input id="avatarInput" type="file" accept="image/*" class="w-full" />
      <div class="mt-4 flex justify-end gap-2">
        <button id="avatarCancel" class="btn-ghost">Cancel</button>
        <button id="avatarUpload" class="btn-primary">Upload</button>
      </div>
    </div>
  </div>
<!-- Loading Spinner -->
<div id="loadingOverlay" class="fixed inset-0 flex items-center justify-center bg-slate-900/50 dark:bg-slate-950/80 backdrop-blur-sm z-[1000]">
  <div class="bg-white/90 dark:bg-slate-900/90 backdrop-blur-xl rounded-2xl p-8 shadow-2xl">
    <div class="animate-spin rounded-full h-12 w-12 border-4 border-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 border-t-transparent"></div>
  </div>
</div>
<script>
document.addEventListener("submit", function(e) {
  if (e.target && e.target.name === "hub-support") {
    e.preventDefault();
    const form = e.target;
    const data = new FormData(form);
    fetch("/", {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: new URLSearchParams(data).toString()
    })
      .then(() => {
        alert("‚úÖ Support request sent! We'll get back to you shortly.");
        form.reset();
      })
      .catch(() => alert("‚ö†Ô∏è Something went wrong. Please try again later."));
  }
});
</script>
</body>
</html>